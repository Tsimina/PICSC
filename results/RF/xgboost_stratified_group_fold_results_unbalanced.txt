=== GRID SEARCH SUMMARY ===
Best mean CV AUC: 0.9095
Best params:
  model__colsample_bytree: 0.6
  model__learning_rate: 0.05
  model__max_depth: 6
  model__n_estimators: 1200
  model__subsample: 0.6

Top 5 parameter sets by mean AUC:
 mean_test_score  std_test_score  param_model__max_depth  param_model__learning_rate  param_model__n_estimators  param_model__subsample  param_model__colsample_bytree
        0.909487        0.035715                       6                        0.05                       1200                     0.6                            0.6
        0.909253        0.035001                       8                        0.05                        400                     0.6                            0.6
        0.908946        0.033023                       6                        0.05                        800                     0.6                            0.6
        0.908891        0.035504                       6                        0.10                        400                     0.6                            0.6
        0.908791        0.034273                       8                        0.05                        400                     0.6                            0.8

Best XGBoost params (clean):
  n_estimators: 1200
  learning_rate: 0.05
  max_depth: 6
  subsample: 0.6
  colsample_bytree: 0.6
  min_child_weight: 1.0
  reg_lambda: 1.0

Running 5-fold StratifiedGroupKFold with tuned params (OOF predictions)...

=== 5-FOLD GROUPED CV (OOF) RESULTS ===
Fold 1: AUC=nan | Acc=0.974 | P=0.000 | R/Sens=0.000 | Spec=0.974 | F1=0.000 (Pos=0, Neg=25914)
Fold 2: AUC=0.935 | Acc=0.876 | P=0.656 | R/Sens=0.920 | Spec=0.863 | F1=0.766 (Pos=137, Neg=483)
Fold 3: AUC=0.917 | Acc=0.823 | P=0.459 | R/Sens=0.840 | Spec=0.820 | F1=0.594 (Pos=94, Neg=517)
Fold 4: AUC=0.912 | Acc=0.830 | P=0.726 | R/Sens=0.891 | Spec=0.792 | F1=0.800 (Pos=330, Neg=534)
Fold 5: AUC=0.898 | Acc=0.790 | P=0.667 | R/Sens=0.858 | Spec=0.750 | F1=0.750 (Pos=317, Neg=545)

OVERALL OOF METRICS (grouped by PCAP/source):
AUC=0.9709 | Accuracy=0.9587 | Precision=0.4156 | Recall/Sens=0.8781 | Specificity=0.9613 | F1=0.5642

Classification report (OOF):
              precision    recall  f1-score   support

      Others     0.9960    0.9613    0.9783     27993
     Spotify     0.4156    0.8781    0.5642       878

    accuracy                         0.9587     28871
   macro avg     0.7058    0.9197    0.7713     28871
weighted avg     0.9784    0.9587    0.9658     28871


ðŸ–¼ï¸ Confusion matrix saved to: e:\master an 2\picsc proiect\start code\xgb_groupcv_confusion_matrix.png

Refitting final model on ALL data for feature importance...

Top feature importances:
         feature  importance
 Direction_Ratio    0.235680
        Bytes_BA    0.186109
        Bytes_AB    0.184504
    Mean_Pkt_Len    0.133591
   Total_Packets    0.091553
      Duration_s    0.060275
         STD_IAT    0.059899
Skewness_Pkt_Len    0.028446
    Kurtosis_IAT    0.019944
PS E:\master an 2\picsc proiect> 